# .gitlab-ci.yml - MkDocs (Material) -> GitLab Pages
image: python:3.11

stages:
  - deploy

variables:
  PIP_CACHE_DIR: "$CI_PROJECT_DIR/.cache/pip"

cache:
  key: "${CI_COMMIT_REF_SLUG}"
  paths:
    - .cache/pip/

pages:
  stage: deploy
  script:
    - python -V
    - pip install --upgrade pip
    # Install from requirements.txt if present, otherwise install essential packages
    - if [ -f requirements.txt ]; then pip install --no-cache-dir -r requirements.txt; else pip install --no-cache-dir mkdocs mkdocs-material mkdocs-glightbox mkdocs-minify-plugin; fi
    - mkdocs build -d public
  artifacts:
    paths:
      - public
  rules:
    - if: $CI_COMMIT_BRANCH == "main"
